<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff src/jdk.jfr/share/classes/jdk/jfr/internal/jfc/model/JFCModel.java</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="../JFC.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="../../management/ChunkFilename.java.udiff.html" target="_top">next &gt;</a></center>    <h2>src/jdk.jfr/share/classes/jdk/jfr/internal/jfc/model/JFCModel.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -1,7 +1,7 @@</span>
  /*
<span class="udiff-line-modified-removed">-  * Copyright (c) 2021, 2022, Oracle and/or its affiliates. All rights reserved.</span>
<span class="udiff-line-modified-added">+  * Copyright (c) 2021, 2025, Oracle and/or its affiliates. All rights reserved.</span>
   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   *
   * This code is free software; you can redistribute it and/or modify it
   * under the terms of the GNU General Public License version 2 only, as
   * published by the Free Software Foundation.  Oracle designates this
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -25,19 +25,19 @@</span>
  package jdk.jfr.internal.jfc.model;
  
  import java.io.IOException;
  import java.io.PrintWriter;
  import java.io.Reader;
<span class="udiff-line-added">+ import java.nio.file.Path;</span>
  import java.text.ParseException;
  import java.util.ArrayList;
  import java.util.Collections;
  import java.util.LinkedHashMap;
  import java.util.List;
  import java.util.Map;
  import java.util.function.Consumer;
  
<span class="udiff-line-removed">- import jdk.jfr.internal.SecuritySupport.SafePath;</span>
  import jdk.jfr.internal.jfc.JFC;
  
  import static java.nio.charset.StandardCharsets.UTF_8;
  
  // Holds the structure of a .jfc file similar to an XML DOM.
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -63,11 +63,11 @@</span>
          this.configuration = new XmlConfiguration();
          this.configuration.setAttribute(&quot;version&quot;, &quot;2.0&quot;);
          this.logger = logger;
      }
  
<span class="udiff-line-modified-removed">-     public void parse(SafePath file) throws IOException, JFCModelException, ParseException {</span>
<span class="udiff-line-modified-added">+     public void parse(Path file) throws IOException, JFCModelException, ParseException {</span>
          JFCModel model = JFCModel.create(file, logger);
          for (var entry : model.controls.entrySet()) {
              String name = entry.getKey();
              // Fail-fast checks that prevents an ambiguous file to be written later
              if (controls.containsKey(name)) {
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -78,11 +78,11 @@</span>
          for (XmlElement child : model.configuration.getChildren()) {
              this.configuration.addChild(child);
          }
      }
  
<span class="udiff-line-modified-removed">-     public static JFCModel create(SafePath file, Consumer&lt;String&gt; logger) throws IOException, JFCModelException, ParseException{</span>
<span class="udiff-line-modified-added">+     public static JFCModel create(Path file, Consumer&lt;String&gt; logger) throws IOException, JFCModelException, ParseException{</span>
          if (file.toString().equals(&quot;none&quot;)) {
              XmlConfiguration configuration = new XmlConfiguration();
              configuration.setAttribute(&quot;version&quot;, &quot;2.0&quot;);
              configuration.setAttribute(&quot;label&quot;, &quot;None&quot;);
              return new JFCModel(configuration);
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -152,11 +152,11 @@</span>
              }
          }
          return result;
      }
  
<span class="udiff-line-modified-removed">-     public void saveToFile(SafePath path) throws IOException {</span>
<span class="udiff-line-modified-added">+     public void saveToFile(Path path) throws IOException {</span>
          try (PrintWriter p = new PrintWriter(path.toFile(), UTF_8)) {
              PrettyPrinter pp = new PrettyPrinter(p);
              pp.print(configuration);
              if (p.checkError()) {
                  throw new IOException(&quot;Error writing &quot; + path);
</pre>
<center><a href="../JFC.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="../../management/ChunkFilename.java.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>